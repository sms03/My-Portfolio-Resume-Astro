---
import BaseLayout from '../layouts/BaseLayout.astro';
const artworks = [
    { src: '/ren1.png', title: 'Skull' },
    { src: '/dbz.png', title: 'Dragon Ball' },
    { src: '/tree.png', title: 'Farm' },
    { src: '/dezi.png', title: 'Daisey' },
    { src: '/roz.png', title: 'Rozey' },
    { src: '/Tulip.jpg', title: 'Tulip' },
    { src: '/fiddle.jpg', title: 'Fiddler' },
    { src: '/edo.jpg', title: 'Edo' }
];
---

<BaseLayout>
    <section class="max-w-6xl mx-auto py-10 px-2 sm:px-6">
        <h1 class="text-5xl mb-6 text-center font-serif tracking-tight italic">Gallery</h1>
        <div class="grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 sm:gap-6">
            {
                artworks.map((art, idx) => (
                    <button
                        class="group relative focus:outline-none rounded-lg overflow-hidden bg-neutral-900/40 hover:shadow-2xl transition-all aspect-square w-full h-full min-h-[180px] max-h-96"
                        type="button"
                        data-idx={idx}
                        tabindex="0"
                    >
                        <img
                            src={art.src}
                            alt={art.title}
                            class="object-cover w-full h-full min-h-[180px] max-h-96 aspect-square transition-transform duration-200 group-hover:scale-110 group-active:scale-95"
                            loading="lazy"
                        />
                        <span
                            class="absolute bottom-2 left-2 right-2 bg-black/70 text-white text-xs sm:text-sm px-2 py-1 rounded font-serif tracking-wide text-center shadow-md pointer-events-none select-none"
                            style="backdrop-filter: blur(2px);"
                        >
                            {art.title}
                        </span>
                    </button>
                ))
            }
        </div>
        <div id="photo-viewer" class="fixed inset-0 z-50 bg-black/90 flex items-center justify-center hidden transition-all duration-300">
            <button
                id="close-viewer"
                class="absolute top-4 right-4 text-white text-3xl font-bold bg-black/40 rounded-full w-12 h-12 flex items-center justify-center hover:bg-red-600/80 transition"
                >&times;</button
            >
            <div class="relative flex flex-col items-center w-full max-w-2xl px-2">
                <div class="w-[90vw] max-w-2xl aspect-square flex items-center justify-center">
                    <img
                        id="viewer-img"
                        src=""
                        alt="Artwork"
                        class="object-cover w-full h-full rounded-lg shadow-2xl border-4 border-white/10 transition-all duration-300 aspect-square"
                    />
                </div>
            </div>
        </div>
    </section>
    <script type="text/javascript">
        const artworks = JSON.parse('{artworks}'.replace(/'/g, '"'));
        let currentIdx = 0;
        function showViewer(idx) {
            currentIdx = idx;
            const viewer = document.getElementById('photo-viewer');
            const img = document.getElementById('viewer-img');
            img.src = artworks[idx].src;
            img.alt = artworks[idx].title;
            viewer.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('viewer-img').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 50);
        }
        function closeViewer() {
            document.getElementById('photo-viewer').classList.add('hidden');
        }
        if (typeof window !== 'undefined') {
            window.showViewer = showViewer;
            window.onload = () => {
                document.querySelectorAll('button[data-idx]').forEach((btn) => {
                    btn.onclick = () => showViewer(Number(btn.getAttribute('data-idx')));
                });
                document.getElementById('close-viewer').onclick = closeViewer;
                document.getElementById('photo-viewer').onclick = (e) => {
                    if (e.target.id === 'photo-viewer') closeViewer();
                };
                document.addEventListener('keydown', (e) => {
                    if (!document.getElementById('photo-viewer').classList.contains('hidden')) {
                        if (e.key === 'Escape') closeViewer();
                    }
                });
            };
        }
    </script>
</BaseLayout>

<style>
    #photo-viewer img {
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }
    @media (max-width: 640px) {
        #photo-viewer .w-[90vw] {
            max-width: 98vw;
            max-height: 80vw;
        }
        #photo-viewer img {
            max-width: 98vw;
            max-height: 80vw;
        }
    }
</style>
